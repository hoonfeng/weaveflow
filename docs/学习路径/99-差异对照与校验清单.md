# 差异对照与校验清单

## 修正项一览
- 删除未实现步骤：`sql.transaction/sql.script/blob.write/blob.read/blob.serve/kv.del/cache.del`
- 统一 `validate` 为单目标写法（`target` 路径）
- `upload.save` 返回 `[]string` 文件ID，不返回文件元数据对象
- 钩子文件路径改为 `configs/hooks/auth.yaml/before.yaml/after.yaml`，去除 `onError`
- Redis KV 配置仅 `type/addr/db`；Qdrant 使用 `endpoint`
- 限流说明改为端点级（接口配置），全局限流中间件暂未挂载
- 认证支持 `jwt` 与 `apikey + HMAC`，不包含 Basic

## 逐条校验方法
- DSL 步骤：对照 `docs/学习路径/00-DSL-能力总览.md` 与 `internal/core/engine.go` 分支实现
- 上传保存：调用示例接口后检查返回是否为文件ID数组；查看 `storage/` 是否生成对应文件名
- 钩子匹配：使用 `POST /api/admin/hooks/inspect` 查看指定端点的有效钩子
- 文档生成：运行 `cmd/manualdoc` 与 `cmd/docgen`，核对 `/docs` 与 `/openapi.json` 输出
- 事务与限流：在接口配置中分别设置 `transaction: { ds }` 与 `rateLimit`，通过并发压测验证限流与出错时回滚
- HMAC：按 `METHOD\nPATH\nTS\nNONCE\nBODY_HASH` 计算签名，请求头包含 `X-Api-Key/X-Timestamp/X-Nonce/X-Signature`

## 参考代码位置
- 引擎步骤：internal/core/engine.go 各 `case` 实现
- 路由事务包装与限流：internal/router/router.go:82–110, 472–483
- HMAC 验签与防重放：internal/router/auth_hmac.go:21–33, 39–59
- 钩子实现与匹配：modules/apphooks/config.go:118–151, 189–211
- 上传保存：internal/datasource/manager.go:119–158

> 按以上清单逐项验证，确保学习路径示例与框架行为完全一致。