# 第一阶段：基础入门（1-2天）

## 1.3 创建第一个简单接口

### 目标
掌握接口配置文件的基本结构，创建并验证第一个简单的接口。

### 1.3.1 接口配置文件位置

**文件位置：** `configs/interfaces/<module>/<endpoint>.yaml`

**目录结构示例：**
```
configs/
├── interfaces/
│   ├── demo/           # 模块目录
│   │   ├── hello.yaml  # 接口配置文件
│   │   └── ping.yaml
│   └── users/
│       ├── list.yaml
│       └── get.yaml
└── project.yaml
```

### 1.3.2 最简单的接口配置

**创建第一个Hello World接口：**
```yaml
# configs/interfaces/demo/hello.yaml
module: demo              # 模块名称
endpoint: hello          # 接口唯一标识
method: GET              # HTTP方法
path: /api/hello        # 接口路径

steps:
  - response:            # 响应步骤
      status: 200        # HTTP状态码
      body:              # 响应体
        message: "Hello, World!"
        timestamp: "{{ now }}"
```

### 1.3.3 接口验证

**启动服务后测试接口：**
```bash
# 启动服务
bin/server.exe

# 测试接口
curl http://localhost:8080/api/hello
```

**预期响应：**
```json
{
  "message": "Hello, World!",
  "timestamp": "2024-01-01T12:00:00Z"
}
```

### 1.3.4 带路径参数的接口

**创建带参数的接口：**
```yaml
# configs/interfaces/demo/greet.yaml
module: demo
endpoint: greet
method: GET
path: /api/greet/{name}

request:
  path:
    name: { type: string, required: true, desc: "用户名" }

steps:
  - response:
      status: 200
      body:
        greeting: "Hello, {{ path.name }}!"
        language: "en"
```

**测试带参数的接口：**
```bash
curl http://localhost:8080/api/greet/John
```

**预期响应：**
```json
{
  "greeting": "Hello, John!",
  "language": "en"
}
```

### 1.3.5 使用模板函数

**在响应中使用模板函数：**
```yaml
# configs/interfaces/demo/info.yaml
module: demo
endpoint: info
method: GET
path: /api/info

steps:
  - response:
      status: 200
      body:
        server_time: "{{ now }}"          # 当前时间
        request_id: "{{ uuid }}"          # 生成UUID
        server_status: "running"
        version: "1.0.0"
```

### 1.3.6 错误处理示例

**创建返回错误响应的接口：**
```yaml
# configs/interfaces/demo/error.yaml
module: demo
endpoint: custom_error
method: GET
path: /api/error

steps:
  - response:
      status: 400
      body:
        code: 1001
        message: "自定义错误信息"
        details: "这是一个示例错误响应"
```

### 1.3.7 实践任务

**完成以下实践任务：**

1. **创建静态响应接口**
   - 创建一个返回固定JSON数据的GET接口
   - 路径：`/api/welcome`
   - 返回欢迎信息和当前时间戳

2. **创建带路径参数的接口**
   - 创建一个接收用户名的接口
   - 路径：`/api/user/{username}/profile`
   - 返回包含用户名的欢迎信息

3. **测试接口功能**
   - 使用curl或浏览器测试所有创建的接口
   - 验证响应格式和内容是否正确

### 1.3.8 常见问题

**Q: 接口修改后为什么没有生效？**
A: 确保 `server.autoReload` 设置为 `true`，或者重启服务。

**Q: 接口访问返回404错误？**
A: 检查配置文件路径和名称是否正确，确保在 `configs/interfaces/` 目录下。

**Q: 如何查看所有已加载的接口？**
A: 访问 `http://localhost:8080/docs` 查看自动生成的接口文档。

### 1.3.9 下一步学习

完成第一个简单接口后，继续学习：[步骤DSL深入学习](../第二阶段/01-步骤DSL深入学习.md) 掌握更复杂的接口配置和数据处理能力。