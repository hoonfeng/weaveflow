# 数据源适配（零代码）

## SQL
- 配置于 `configs/project.yaml` → `datasources.sql.*`
- 查询与执行：
```yaml
- sql.query:
    ds: main
    sql: "SELECT id,name FROM users WHERE id = ?"
    params: { id: "{{ toint(path.id) }}" }
    order: [id]
    out: user
- sql.exec:
    ds: main
    sql: "UPDATE users SET name=? WHERE id=?"
    params: { name: "{{ body.name }}", id: "{{ toint(path.id) }}" }
    order: [name, id]
```
- SQL 日志：写入 `ctx.vars.sql_log`，便于调试与审计。

## KV 与 Cache
```yaml
- kv.set: { ds: default, key: "user:{{ path.id }}", value: "{{ user }}" }
- kv.get: { ds: default, key: "user:{{ path.id }}", out: user }
- cache.set: { key: "cfg:v1", value: on, ttl: 5m }
- cache.get: { key: "cfg:v1", out: cfg }
```

## Blob 存储
- 本地存储：`blob.local`，见上传章节。

## 向量库
- 内存或 Qdrant：在 `project.yaml` 的 `datasources.vector` 中配置。
```yaml
- vector.ensure: { ds: vec, collection: default, size: 1536, metric: Cosine }
- vector.upsert: { ds: vec, collection: default, id: "{{ body.id }}", vec: "{{ body.embedding }}", meta: "{{ body.meta }}" }
- vector.search: { ds: vec, collection: default, vec: "{{ body.embedding }}", topK: 10, out: hits }
```